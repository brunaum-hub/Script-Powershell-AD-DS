Import-Module ActiveDirectory

# Configurações
$dominio = "techangels.com.br"
$ouUsuarios = "OU=Usuarios,DC=techangels,DC=com,DC=br"
$qtdUsuarios = 35

# Listas de nomes e sobrenomes para gerar combinações aleatórias
$primeirosNomes = @("Lucas", "Mariana", "Felipe", "Amanda", "Bruno", "Isabela", "Rafael", "Julia", "Thiago", "Camila", "Henrique", "Vanessa", "André", "Renata", "Fábio")
$sobrenomes = @("Silva", "Souza", "Oliveira", "Costa", "Pereira", "Almeida", "Martins", "Lima", "Barbosa", "Ribeiro", "Torres", "Cunha", "Rezende", "Moreira", "Braga")

# Criar os usuários
for ($i = 1; $i -le $qtdUsuarios; $i++) {
    $matricula = "{0:D4}" -f $i
    $samAccountName = "user" + $matricula

    # Nome aleatório
    $nome = $primeirosNomes | Get-Random
    $sobrenome = $sobrenomes | Get-Random
    $nomeCompleto = "$nome $sobrenome"

    # Senha padrão (altere se necessário)
    $senha = ConvertTo-SecureString "SenhaTemp123!" -AsPlainText -Force

    # Verifica se o usuário já existe
    if (-not (Get-ADUser -Filter { SamAccountName -eq $samAccountName })) {
        Write-Host "Criando usuário: $nomeCompleto ($samAccountName)"

        New-ADUser `
            -Name $nomeCompleto `
            -SamAccountName $samAccountName `
            -UserPrincipalName "$samAccountName@$dominio" `
            -AccountPassword $senha `
            -Enabled $true `
            -PasswordNeverExpires $true `
            -Path $ouUsuarios `
            -DisplayName $nomeCompleto `
            -GivenName $nome `
            -Surname $sobrenome `
            -Description "Criado automaticamente em $(Get-Date -Format 'dd/MM/yyyy')" `
            -ChangePasswordAtLogon $true
    } else {
        Write-Host "Usuário $samAccountName já existe. Pulando..."
    }
}

